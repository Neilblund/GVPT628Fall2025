---
title: "Homework 4: Data manipulation and plotting"
format:
  html:
    toc: true
    df-print: kable
    code-tools: true
    embed-resources: true
---

```{=html}
<style>
.qbox {
  background-color: #cccccc; 
  padding: 20px; 
  border: 1px solid #999999; 
  border-left: 10px solid teal; 
  border-radius: 10px;
  margin: 10px;
}

</style>
```

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

```


You'll use data from the 2024 round of the General Social Survey to answer these questions. Scroll to @sec-codebook at the end of this document for some additional details on the variables you'll need to complete this analysis.


# Data import

You can download GSS data [directly from their website](https://gss.norc.org/us/en/gss/get-the-data.html), but Kieran Healy [has created an R package](https://kjhealy.github.io/gssr/) that will automatically import `GSS` data into R and provides some additional helper functions for working with the data.

Download the `gssr` and `gssrdoc` packages by running the code below:

```{r, eval=FALSE}
install.packages('gssr', repos =
  c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))

install.packages('gssrdoc', repos =
  c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))

```

Then you'll want to run the code below to set up your data for analysis.

```{r}
library(tidyverse)
library(srvyr)
library(gssr)
library(gssrdoc)
library(haven)
gss<-gss_get_yr(year='2024')
wt_vars <- c("vpsu",     # PSU
             "vstrat",   # Strata          
             "wtssps",   # Weights
             "wtssnrps"  #  Weights with non-response adjustment
             )   

# removing user-missing values and converting the weights to numeric
gss<-gss|>
  zap_missing()|>
  mutate(across(wt_vars, .fns=~as.numeric(.x)))

```

## Question 1

Generate histograms or density plots to compare the distribution of `wtssps` against the `wtssnrps` weighting variables in the regular data set (you don't need to use `as_survey_design` yet). How and why are these values different?

```{r}
# code here


```

## Question 2

Use a visual or summary statistic to examine how the weighting variable `wtssnrps` differs for people aged 30 or older vs. people under age 30.

Which group appears to have the highest average weights? And what does this tell you about the sample?

```{r}
# Code here



```




# Analysis Section

::: {.callout-important}

For questions 3 and 4, you'll want to use the survey weights using `as_survey_design`.

You should use `wtssnrps` as your weighting variable, the `vpsu` variable for the `ids` and `vstrat` for the strata.


:::






## Question 3

How does social trust relate to attitudes about American identity?

The 2024 round of the General Social Survey asks a series of questions about American identity. One of those questions, labeled `brneffrt` in the codebook, asks respondents whether they think someone born outside of America can become "truly American" if they make an effort.

Another question from the same round,`cantrust`, asks respondents whether they think people can generally be trusted.



```{r}
# Code here


```




# Question 4

Do your results from question 3 differ when you dis-aggregate the data by party ID? 

Recode the `partyid` variable into a 3-category measure of party ID, then either use filtering to create separate plots for Democrats, Republicans, or Independents, or use [`facet_wrap`](https://ggplot2.tidyverse.org/reference/facet_wrap.html?q=facet_wrap#null) to make a faceted plot for each group.

(note: independents who lean towards a particular party are usually treated as partisans)



```{r}
# Code here


```

# GSS Variables {#sec-codebook}

::: qbox
### **wtssps**

Post-stratification weights.

### **wtssnrps**

Post-stratified weights with adjustments for non-response.

### **vpsu**

Variance primary sampling unit

### **vstrat**

Variance stratum

### **brneffrt**

Categorical (Single)

*Some people say that it is possible to become truly American if a person makes an effort. Others say a person has to be born American to be truly American. What is your position?*

**Statement A**: It is possible to become truly American if a person makes an effort.

**Statement B**: A person has to be born American to be truly American.

Categories:

-   I definitely agree with statement A

-   I agree more with statement A than with statement B

-   I agree more with statement B than with statement A

-   I definitely agree with statement B

-   Can't choose

### **cantrust**

Categorical (Single)

*Generally speaking, would you say that people can be trusted or that you can't be too careful in dealing with people?*

Categories:

-   People can almost always be trusted

-   People can usually be trusted

-   You usually can't be too careful in dealing with people

-   You almost always can't be too careful in dealing with people

-   can't choose

### **partyid**

Categorical (Single)

*Generally speaking, do you usually think of yourself as a Republican, Democrat, Independent, or what?*

Categories:

-   Strong democrat

-   Not very strong democrat

-   Independent, close to democrat

-   Independent (neither, no response)

-   Independent, close to republican

-   Not very strong republican

-   Strong republican

-   Other party
:::
